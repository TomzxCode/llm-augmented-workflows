# Plan for Issue #1: Automated issue planning

## Issue Summary

**Title:** Automated issue planning
**Issue Number:** 1
**Repository:** TomzxCode/llm-augmented-workflows

**Description:**
When a task is created, Claude Code should immediately analyze it, determine its feasibility, and if feasible, generate a plan. The plan should then be shared for further review by the issue creator and the repository developers.

## Feasibility Assessment

**Status:** ✅ Feasible

**Complexity:** Low to Medium

**Estimated Effort:** Small configuration change with testing

**Analysis:**
This request is highly feasible because the repository already has the complete infrastructure for automated issue planning:
- Existing `claude-plan.yml` workflow with plan generation logic
- Complete `/generate-plan` slash command implementation
- Plan storage system (`plans/` directory)
- PR creation and review workflows

The only modification needed is changing the trigger in `.github/workflows/claude-plan.yml` from label-based (`plan-needed`) to automatic on issue creation.

## Proposed Solution

### Overview

Modify the `claude-plan.yml` workflow to automatically trigger when any new issue is created, removing the dependency on manual labeling. This enables immediate automated planning for all new issues.

### Implementation Steps

1. **Update workflow trigger in `.github/workflows/claude-plan.yml`**
   - Change from: `types: [opened, labeled]` with conditional label check
   - Change to: `types: [opened]` only
   - Remove or update the `TRIGGER_LABEL` environment variable handling
   - Simplify the conditional logic that checks for the label

2. **Update workflow conditional logic**
   - Remove the `if: github.event.action == 'labeled' && github.event.label.name == env.TRIGGER_LABEL || github.event.action == 'opened' && env.TRIGGER_LABEL == ''` condition
   - Simplify to always run when an issue is opened
   - Alternatively: Keep label trigger as an additional option for re-triggering plan generation

3. **Consider keeping label as optional re-trigger mechanism**
   - Keep both `opened` and `labeled` event types
   - Add conditional: if issue is opened OR if specific label is added (for re-generation scenarios)
   - This provides flexibility for both automatic and manual triggering

4. **Test the workflow**
   - Create a test issue to verify automatic plan generation triggers
   - Verify plan PR is created automatically
   - Verify plan file is created in `plans/` directory
   - Verify issue comment is added with plan link

5. **Update documentation**
   - Update `PLAN.md` to reflect automatic triggering behavior
   - Update `CLAUDE.md` if needed to document the trigger mechanism
   - Add README or docs explaining the automatic workflow to users

### Dependencies

- No external dependencies required
- Existing workflows and commands remain unchanged
- GitHub Actions permissions already configured appropriately

### Risk Assessment

**Risks:**
- **Low Risk:** Workflow triggers on every issue creation, including potential spam or test issues
  - Mitigation: Can add conditional logic to skip certain labels (e.g., `skip-planning`)
  - Mitigation: Rate limiting already handled by GitHub Actions quotas

- **Low Risk:** Accidental re-triggering when editing issues
  - Mitigation: Trigger is only on `opened` event, not `edited`

- **Low Risk:** Plan generation failures could create noise
  - Mitigation: `/generate-plan` command already handles infeasible scenarios gracefully by commenting

**Benefits:**
- ✅ Zero manual intervention required for plan generation
- ✅ Faster feedback loop for issue creators
- ✅ Consistent planning process for all issues
- ✅ Maintains all existing review and approval workflows

## Alternatives Considered

### Alternative 1: Keep label-based triggering with improved documentation
**Approach:** Document the `plan-needed` label requirement clearly in issue templates and README
**Pros:** More control over when planning happens, avoids processing test/spam issues
**Cons:** Requires manual step, defeats the "immediate" requirement from the issue
**Decision:** Rejected - doesn't meet the "immediately analyze" requirement

### Alternative 2: Hybrid approach with configurable filter
**Approach:** Trigger automatically but skip issues with certain labels (e.g., `question`, `discussion`)
**Pros:** Automatic for most cases, allows opt-out for non-feature issues
**Cons:** More complex logic, requires label discipline
**Decision:** Could be implemented as enhancement, but start simple first

### Alternative 3: Use issue templates with checkboxes to opt-in
**Approach:** Issue templates include checkbox for "Generate automated plan"
**Pros:** User control, explicit consent
**Cons:** Requires parsing issue body, more fragile, still requires user action
**Decision:** Rejected - adds complexity and manual step

## Implementation Notes

### Files to Modify
1. `.github/workflows/claude-plan.yml` - Primary change to trigger configuration

### Configuration Options to Consider
- Keep `TRIGGER_LABEL` as optional re-trigger mechanism
- Add `SKIP_LABELS` to exclude certain issue types (optional enhancement)
- Consider adding `concurrency` group to prevent race conditions

### Testing Strategy
1. Create test issue in a fork or test repository
2. Verify workflow triggers automatically
3. Verify plan PR creation
4. Verify plan file creation
5. Test re-triggering with label (if kept)
6. Test with different issue types (feature, bug, question)

## References

- Existing workflow: `.github/workflows/claude-plan.yml`
- Plan generation command: `.claude/commands/generate-plan.md`
- Project documentation: `PLAN.md`
- GitHub Actions docs: [Workflow syntax for GitHub Actions](https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions)
- Issue event types: [Issues event](https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#issues)
